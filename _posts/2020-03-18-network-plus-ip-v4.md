---
layout: post
title: NetworkPlus - IP v4
category: note
date: 2020-03-18T12:00:00
tags: comptia network-plus
comments: false
---
درباره ساختار IP ورژن ۴ و subnetting
<!--break-->

آی‌پی از دو قسمت network و host تشکیل شده که برای تشخیص باید از subnet mask استفاده میکنیم.
```
IP adress:		192.168.255.127	    11000000.10101000.11111111 .01111111
Subnet mask:	        255.255.255.0       11111111.11111111.11111111 .00000000
                                            00000000.00000000.00000000 .11111111
```
این دوتارو بصورت باینری در هم and میکنیم. تا اونجایی که همه ۱ هستن network و صفر ها hostن که توی مثال پستچی network مثل خیابان و host پلاک مقصد است
```
Network:	192.168.255.0
Broadcast:      192.168.255.255
HostMin:	192.168.255.1
HostMax:	192.168.255.254
```

## کلاس بندی آی‌پی X.Y.Z.W

| Class | 1st Octet | 1st octet bits | Network/Host | Default subnet mask |
|-------|-----------|----------------|--------------|---------------------|
| A | 1-126 | 0xxxxxxx | N.H.H.H | 255.0.0.0 |
| B | 128-191 | 10xxxxxx | N.N.H.H | 255.255.0.0 |
| C | 192-223 | 110xxxxx | N.N.N.H | 255.255.255.0 |
| D | 224-239 | 1110xxxx | Multicast | Multicast |
| E | 240-254 | 1111xxxx | Experimental | Experimental |

Multicast رو بعضی جاها شاید ببینیم

Experimental رزرو شده برای کارای تحقیقاتی و هیشکی نباید استفاده کنه

- ما IP رو به دو دسته تقسیم میکنیم که یکسری public و private هستن. البته به public ها valid و به private ها invalid گفته میشه که اشتباه هم هست.
- چون IP v4 داشت تموم میشد اومدن یه سری رنج رو خالی کردن که برای داخل سازمان به صورت private استفاده شن و رایگانم هستن.

| Class | Network | Subnet mask | Address range |
|-------|-------------|-------------|-------------------------------|
| A | 10.0.0.0 | 255.0.0.0 | 10.0.0.0 - 10.255.255.255 |
| B | 172.16.0.0 | 255.240.0.0 | 172.16.0.0 - 172.31.255.255 |
| C | 192.168.0.0 | 255.255.0.0 | 192.168.0.0 - 192.168.255.255 |

غیر از جدول بالا که private هستن رو از جدول اول کم کنیم باقیشون public محسوب میشن و براشون باید پول پرداخت شه.

یه سری استثنی هم داریم:

| Name | IP | Subnet mask |
|------------------|-------------------------------|-------------|
| APIPA (zeroconf) | 169.254.0.0 - 169.254.255.255 | 255.255.0.0 |
| Loopback IP | 127.0.0.1 | 255.255.0.0 |

مورد APIPA در واقع رنج رزروشده ماکروسافته که وقتی dhcp و باقی چیزا توی شبکه از کار افتاده هر کارت شبکه به طور اتوماتیک یه IP ازین رنج میگیره تا بتونه تو شبکه کاراشو انجام بده و هر ۵ دقیقه هم رفرش میشه. مشکل APIPA هم اینه بهمون آی‌پی میده ولی gateway نمیده.

همونطور که میدونیم IP که با 127 شروع شه رو نمیتونیم استفاده کنیم. در واقع این ادرس به خود سیستم اشاره داره و برای تست روی شبکه خودمون وب سرور میسازیم که ببینیم آیا ۷ لایه شبکه بدرستی کار میکنن یا نه. بهش localhost هم میگن.


## سابنت مسک
توی سابنت مسک که به صورت باینری بنویسیم یک سمت صفرها هستن و یک طرف یک ها که همون مرز بین network و host عه

```
IP address:		172.16.0.127		10101100.00010000 .00000000.01111111
Subnet mask:	        255.255.0.0		11111111.11111111 .00000000.00000000
                                                00000000.00000000 .11111111.11111111

Network:		172.16.0.0/16		10101100.00010000.00000000.00000000
Broadcast:		172.16.255.255		10101100.00010000.11111111.11111111
HostMin:		172.16.0.1 		10101100.00010000.00000000.00000001
HostMax:		172.16.0.254      	10101100.00010000.11111111.11111111
Hosts:			2^16-2 = 65k
```

برا بدست آوردن network در واقع سابنت رو در آی‌پی and میکنیم

به اون قسمت بعد اسلش توی نتورک prefix هم میگن و تعداد ۱ های توی سابنت مسکه. مثلا ۱۶ نشون میده که ۱۶ بیت برای network و ۱۶ بیت هم برای host باقی مونده

آدرس broadcast در واقع آخرین آدرس توی اون رنج آی‌پیه. یعنی همه ی بیت های host باید ۱ بشن.

آدرس HostMin یدونه بیشتر از Network عه

آدرس HostMax یدونه کمتر از broadcast عه

#### یه مثال دیگه:

```
IP address:     172.16.0.127/17         10101100.00010000.0 0000000.01111111
Subnet mask:    ?.?.?.?                 11111111.11111111.1 0000000.00000000
                255.255.128.0

Network:        172.16.0.0/17         10101100.00010000.0 0000000.00000000
Broadcast:      172.16.127.255        10101100.00010000.0 1111111.11111111
HostMin:        172.16.0.1            10101100.00010000.0 0000000.00000001
HostMax:        172.16.127.254        10101100.00010000.0 1111111.11111110
Hosts:          2^15-2 = 32k
```

برای این کارا از سایت [jodies](https://jodies.de/ipcalc) هم میتونیم استفاده کنیم.

بسته های برودکست نهایتا تا روتر میرسن.

برای یه کامپیوتر مهمه که کامپیوتری که باهاش کار داره تو شبکه خودشه یا نه!؟ برای اینکه بفهمه میاد IP خودشو در subnet خودش and میکنه تا network رو بدست بیاره. حالا IP مقصد رو هم در subnet خودش and میکنه و اگر باهم برابر بودن ینی تو یه شبکه‌ن و اگر اینطور نباشه کلا بسته رو drop میکنه.

حالا مفهومی داریم به اسم gateway که اگر ببینه مقصد تو شبکش نیست به اون تحویل میده. معمولا به gateway اولین IP شبکه رو اختصاص میدن

یه موردیم هست کارت شبکه بعد اینکه IP بصورت دستی روش ست شد، خودشو ARP میزنه و درصورتی که کسی بهش جواب بده یعنی یک نفر اون IP رو از قبل رزرو کرده و نمیتونه ازون IP استفاده کنه. توی ماکروسافت میره روی APIPA و توی سیسکو آی‌پی صفر میشه.